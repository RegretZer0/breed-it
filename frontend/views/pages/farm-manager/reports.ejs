<%- include("../../partials/farm-manager/header") %>
<%- include("../../partials/farm-manager/navbar") %>
<%- include("../../partials/farm-manager/sidepanel") %>

<!-- Main content -->
<main class="main-content">
  <div class="container-fluid">
    <!-- <div class="card page-card"> -->
        <div class="card page-card overview-card">
          <div class="card-body">
              <h4 class="page-title">FARMER REPORTS</h4>


            <!-- STATS GRID -->
            <div class="row g-3 stats-grid">
              <div class="col-md-6 col-lg-3">
                <div class="stat-card d-flex justify-content-between align-items-center">
                  <div>
                    <div class="stat-label">In-Heat</div>
                    <div class="stat-number" id="countInHeat">0</div>
                  </div>
                  <div class="stat-icon orange">
                    <i class="fa-solid fa-fire"></i>
                  </div>
                </div>
              </div>

              <div class="col-md-6 col-lg-3">
                <div class="stat-card d-flex justify-content-between align-items-center">
                  <div>
                    <div class="stat-label">Under Observation</div>
                    <div class="stat-number" id="countAwaitingRecheck">0</div>
                  </div>
                  <div class="stat-icon blue">
                    <i class="fa-solid fa-clock-rotate-left"></i>
                  </div>
                </div>
              </div>

              <div class="col-md-6 col-lg-3">
                <div class="stat-card d-flex justify-content-between align-items-center">
                  <div>
                    <div class="stat-label">Pregnant</div>
                    <div class="stat-number" id="countPregnant">0</div>
                  </div>
                  <div class="stat-icon green">
                    <i class="fa-solid fa-piggy-bank"></i>
                  </div>
                </div>
              </div>

              <div class="col-md-6 col-lg-3">
                <div class="stat-card d-flex justify-content-between align-items-center">
                  <div>
                    <div class="stat-label">Farrowing Soon</div>
                    <div class="stat-number" id="countFarrowingReady">0</div>
                  </div>
                  <div class="stat-icon red">
                    <i class="fa-solid fa-warehouse"></i>
                  </div>
                </div>
              </div>
            </div>

            <!-- DIVIDER -->
            <hr style="margin: 24px 0;">

            <!-- FILTER SECTION -->
            <h5 class="card-title">Filter Reports</h5>

            <div class="filter-row">
              <input type="text" id="filterSwine" placeholder="Swine ID">

              <select id="filterStatus">
                <option value="">All Status</option>
                <option value="pending">Pending</option>
                <option value="approved">Approved</option>
                <option value="waiting_heat_check">Under Observation</option>
                <option value="pregnant">Pregnant</option>
              </select>

              <button id="applyFilter">Apply</button>
              <button id="clearFilter" class="secondary">Clear</button>
            </div>

            <!-- FILTERED RESULTS (INSIDE SAME CARD) -->
            <div
              id="filteredResultsCard"
              style="display:none; margin-top: 24px;"
            >
              <hr style="margin: 24px 0;">

              <h5 class="card-title">Filtered Results</h5>

              <div class="table-responsive">
                <table class="reports-table">
                  <thead>
                    <tr>
                      <th>Swine ID</th>
                      <th>Farmer</th>
                      <th>Date</th>
                      <th>Status</th>
                      <th>Action</th>
                    </tr>
                  </thead>
                  <tbody id="filteredTableBody"></tbody>
                </table>
              </div>
            </div>

          </div>
        </div>



        <!-- REPORTS TABLE CARD -->
        <div class="card page-card reports-card" style="margin-top: 20px;">
          <div class="card-body">

            <div class="card-header-row">
              <h5 class="card-title">Heat Reports</h5>
            </div>

            <div class="table-responsive">
              <table class="reports-table">
                <thead>
                  <tr>
                    <th>Swine ID</th>
                    <th>Farmer</th>
                    <th>Date Reported</th>
                    <th>Probability</th>
                    <th>Status</th>
                    <th>Next Heat</th>
                    <th>Expected Farrowing</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody id="reportsTableBody">
                  <tr>
                    <td colspan="8">Loading reports...</td>
                  </tr>
                </tbody>
              </table>
            </div>

          </div>
        </div>

        <!-- REPORT DETAILS CARD -->
        <div
          id="reportDetails"
          class="card page-card report-details-card"
          style="display:none; margin-top: 24px;"
        >
          <div class="card-body">

            <div class="card-header-row">
              <h5 class="card-title">Report Details</h5>
            </div>

            <!-- DETAILS GRID -->
            <div class="detail-grid">
              <p id="reportSwine"></p>
              <p id="reportFarmer"></p>
              <p id="reportProbability"></p>
              <p id="reportStatus"><strong>Status:</strong> --</p>
              <p id="reportSigns" style="grid-column: span 2;"></p>
            </div>

            <!-- MEDIA SECTION -->
            <div class="media-wrapper">
              <video id="reportVideo" controls style="display:none;"></video>
              <img id="reportImage" style="display:none;" />
            </div>

            <!-- ACTION BUTTONS -->
            <div class="report-actions">
              <button id="approveBtn" style="display:none;">Approve</button>
              <button id="rejectBtn" style="display:none;">Reject</button>
              <button id="confirmAIBtn" style="display:none;">Confirm AI</button>
              <button id="confirmPregnancyBtn" style="display:none;">Confirm Pregnancy</button>
              <button
                class="secondary"
                onclick="document.getElementById('reportDetails').style.display='none'">
                Close
              </button>
            </div>

          </div>
        </div>


       
      </div>
    </div>
  </div>
</main>
 <!-- AI CONFIRMATION MODAL (REQUIRED FOR CONFIRM AI FLOW) -->
        <div id="aiConfirmModal" class="modal">
          <div class="modal-content">
            <h3>ðŸ’‰ Confirm AI Service</h3>

            <label for="boarSelect">Select Sire (Boar)</label>
            <select id="boarSelect"></select>

            <div style="display: flex; gap: 10px; margin-top: 15px;">
              <button
                id="submitAI"
                class="btn-nav"
                style="flex: 1; background: var(--stat-blue); color: #fff;">
                Confirm AI
              </button>

              <button
                type="button"
                class="btn-nav secondary"
                style="flex: 1;"
                onclick="document.getElementById('aiConfirmModal').style.display='none'">
                Cancel
              </button>
            </div>
          </div>
        </div>


<%- include("../../partials/farm-manager/footer") %>
