<%- include("../../partials/farmer/farmer_nav") %>

<div class="app-root">
  <main class="profile-container">
    <h2 class="page-title">PROFILE</h2>

    <!-- VIEW PROFILE -->
    <section id="viewProfile" class="profile-card">

      <div class="profile-avatar" id="avatarPreview">
        <i class="fa-solid fa-user"></i>
      </div>

      <!-- FULL NAME -->
      <h3 id="profileName">Loading...</h3>
      <p class="role">Pig Farmer</p>

      <div class="info-row">
        <span>Farmer ID</span>
        <strong id="farmer_id">-</strong>
      </div>

      <div class="info-row">
        <span>Email</span>
        <strong id="email">-</strong>
      </div>
      
      <div class="info-row">
        <span>Contact Number</span>
        <strong id="contact_no">-</strong>
      </div>

      <div class="info-row">
        <span>Address</span>
        <strong id="address">-</strong>
      </div>

      <div class="info-row">
        <span>Number of Pens</span>
        <strong id="num_of_pens">0</strong>
      </div>

      <div class="info-row">
        <span>Pen Capacity</span>
        <strong id="pen_capacity">0</strong>
      </div>

      <p id="profileMessage" class="small text-danger mt-2"></p>

      <button class="edit-btn" id="editProfileBtn">
        <i class="fa-solid fa-pen"></i> EDIT PROFILE
      </button>
    </section>

    <!-- EDIT PROFILE (UI only) -->
    <section id="editProfile" class="profile-card hidden">
      <h4>Edit Profile</h4>

      <label>Name</label>
      <input type="text" id="editName" disabled />

      <label>Email</label>
      <input type="email" id="editEmail" disabled/>

      <label>Contact Number</label>
      <input type="text" id="editContact_no" />

      <label>Address</label>
      <input type="text" id="editAddress" />

      <label>Number of Pens</label>
      <input type="number" id="editNumPens" min="0"/>

      <label>Pen Capacity</label>
      <input type="number" id="editPenCapacity" min="0"/>

      <hr class="profile-divider">

      <h5 class="mt-2">Change Password</h5>

      <button type="button" class="edit-btn" id="openChangePassword">
        Change Password
      </button>


      <div class="actions">
        <button class="cancel-btn" id="cancelEdit">CANCEL</button>
        <button class="save-btn">SAVE</button>
      </div>
    </section>
  </main>
</div>

<!-- PREVIEW MODAL -->
<div id="previewModal" class="modal hidden">
  <div class="modal-content">
    <h3>Confirm Profile Changes</h3>

    <div class="modal-preview">
      <p><strong>Name:</strong> <span id="previewName"></span></p>
      <p><strong>Email:</strong> <span id="previewEmail"></span></p>
      <p><strong>Contact:</strong> <span id="previewContact"></span></p>
      <p><strong>Address:</strong> <span id="previewAddress"></span></p>
      <p><strong>Number of Pens:</strong> <span id="previewNumPens"></span></p>
      <p><strong>Pen Capacity:</strong> <span id="previewPenCapacity"></span></p>
    </div>

    <div class="modal-actions">
      <button id="previewCancel" class="cancel-btn">CANCEL</button>
      <button id="previewConfirm" class="save-btn">CONFIRM</button>
    </div>
  </div>
</div>

<div id="changePasswordModal" class="modal hidden">
  <div class="modal-content change-password-modal">

    <h3 class="modal-title">Change Password</h3>

  <!-- SEND OTP (STEP 1) -->
  <button
    class="btn-otp w-100"
    id="requestChangeOtpBtn"
    type="button"
  >
    Send OTP to Email
  </button>

  <form id="changePasswordForm" class="mt-3">

    <div class="form-group">
      <label for="changeOtp">OTP</label>
      <input
        type="text"
        id="changeOtp"
        class="form-control otp-input"
        required
      />
    </div>

    <div class="form-group">
      <label for="changeNewPassword">New Password</label>
      <input
        type="password"
        id="changeNewPassword"
        class="form-control"
        required
      />
    </div>

      <p id="changePasswordMessage" class="modal-message"></p>

    <div class="change-password-actions">
      <button type="button" class="btn-cancel" id="closeChangePassword">
        Cancel
      </button>

      <button type="submit" class="btn-primary">
        Confirm
      </button>
    </div>

  </form>

<%- include("../../partials/farmer/farmer_footer") %>